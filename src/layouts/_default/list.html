{{ define "main" }}

{{ $ps := where (where .Site.Pages "Type" .Type) "Title" "!=" .Title }}
{{ if eq .CurrentSection.Type "events" }}
  {{ $ps = where (where .Site.Pages "Kind" "section") "Title" "!=" .Title }}
{{ end }}

{{ if eq (getenv "HUGO_ENV") "debug" | or (eq .Site.Params.env "debug")  }}
</ul>
  <li>layout: layouts/_default/list.html</li>
  <li>$ps: {{ $ps }}</li>
</ul>
{{ end }}

<h1 class="post-title">{{ .Title | markdownify }}</h1>

{{ with .Content }}
<div class="index-content">
  {{ . }}
</div>
{{ end }}

<div>
  {{ range $ps }}
  <article class="on-list">
    <h2>
      {{ if eq .Kind "section" }}
      <a href="{{ .Permalink }}">
        {{ .Title | markdownify }}
      </a>
      {{ else }}
      <a href="{{ .Permalink }}">
        Zone {{ .Params.Zone | markdownify }} ::
        Gear {{ .Params.Gear | markdownify }} ::
        {{ .Params.Category | markdownify }} ::
        #{{ .Params.Question | markdownify }}
      </a>
      {{ end }}
    </h2>
  </article>
  {{ end }}

  {{ partial "pagination.html" . }}
</div>

{{ end }}
